# Phase 2 ì°¸ê³  íŒŒì¼ Align ê³„íš

## ì°¸ê³  íŒŒì¼ ëª©ë¡

1. `upstage_api_client_REF.py`: Upstage API í´ë¼ì´ì–¸íŠ¸
2. `pdf_parser_REF.py`: PDF íŒŒì„œ
3. `cache_manager_REF.py`: ìºì‹œ ë§¤ë‹ˆì €

## ì£¼ìš” ì°¨ì´ì  ìš”ì•½

### 1. ì´ëª¨ì§€ ì‚¬ìš©
- **ì°¸ê³  íŒŒì¼**: ì´ëª¨ì§€ ì‚¬ìš© (ğŸ“„, ğŸ“¡, âœ…, âŒ, ğŸ’¾, ğŸ” ë“±)
- **í˜„ì¬ í”„ë¡œì íŠ¸**: ì´ëª¨ì§€ ì‚¬ìš© ê¸ˆì§€ â†’ `[INFO]`, `[ERROR]`, `[CACHE_SAVE]` í˜•ì‹ ì‚¬ìš©

### 2. ë¡œê¹… í˜•ì‹
- **ì°¸ê³  íŒŒì¼**: ì¼ë°˜ ë¡œê¹… (`logger.info()`, `logger.error()`)
- **í˜„ì¬ í”„ë¡œì íŠ¸**: `[INFO]`, `[ERROR]`, `[WARNING]` í˜•ì‹ ì‚¬ìš©

### 3. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¨ì´
- **ì°¸ê³  íŒŒì¼**: `PyPDF2` ì‚¬ìš©
- **í˜„ì¬ í”„ë¡œì íŠ¸**: `pypdf` ì‚¬ìš© â†’ ë³€ê²½ í•„ìš”

### 4. ì„¤ì • ê´€ë¦¬
- **ì°¸ê³  íŒŒì¼**: `settings.upstage_api_key` ì§ì ‘ ì‚¬ìš©
- **í˜„ì¬ í”„ë¡œì íŠ¸**: `Settings` í´ë˜ìŠ¤ ì‚¬ìš© (`settings.upstage_api_key`)

### 5. ìºì‹œ ë””ë ‰í† ë¦¬
- **ì°¸ê³  íŒŒì¼**: `Path("cache/upstage")` ê¸°ë³¸ê°’
- **í˜„ì¬ í”„ë¡œì íŠ¸**: `settings.cache_dir / "upstage"` ì‚¬ìš©

### 6. ì–‘ë©´ ë¶„ë¦¬ ë¡œì§
- **ì°¸ê³  íŒŒì¼**: `_split_pages_by_side()` ë©”ì„œë“œ í¬í•¨
- **í˜„ì¬ í”„ë¡œì íŠ¸**: í•„ìš” ì—¬ë¶€ í™•ì¸ í•„ìš” (í˜„ì¬ í”„ë¡œì íŠ¸ì—ëŠ” ì—†ì„ ìˆ˜ ìˆìŒ)

### 7. clean_output ì˜µì…˜
- **ì°¸ê³  íŒŒì¼**: `clean_output` ì˜µì…˜ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ í•„ë“œ ì œê±°
- **í˜„ì¬ í”„ë¡œì íŠ¸**: í•„ìš” ì—¬ë¶€ í™•ì¸ í•„ìš”

## í´ë˜ìŠ¤ëª…/í•¨ìˆ˜ëª… ë§¤í•‘ í…Œì´ë¸”

### UpstageAPIClient

| ì°¸ê³  íŒŒì¼ | í˜„ì¬ í”„ë¡œì íŠ¸ | ë³€ê²½ ì‚¬í•­ |
|-----------|--------------|----------|
| `UpstageAPIClient` | `UpstageAPIClient` | ë™ì¼ (ìœ ì§€) |
| `parse_pdf()` | `parse_pdf()` | ë™ì¼ (ìœ ì§€) |
| `_get_pdf_page_count()` | `_get_pdf_page_count()` | ë™ì¼ (ìœ ì§€) |
| `_split_pdf()` | `_split_pdf()` | ë™ì¼ (ìœ ì§€) |
| `_parse_pdf_in_chunks()` | `_parse_pdf_in_chunks()` | ë™ì¼ (ìœ ì§€) |
| `_parse_single_pdf()` | `_parse_single_pdf()` | ë™ì¼ (ìœ ì§€) |

**ë³€ê²½ í•„ìš” ì‚¬í•­**:
- `PyPDF2` â†’ `pypdf` ë³€ê²½
- ì´ëª¨ì§€ ì œê±°, ë¡œê¹… í˜•ì‹ ë³€ê²½
- ì„¤ì • ê´€ë¦¬: `Settings` í´ë˜ìŠ¤ ì‚¬ìš©

### PDFParser

| ì°¸ê³  íŒŒì¼ | í˜„ì¬ í”„ë¡œì íŠ¸ | ë³€ê²½ ì‚¬í•­ |
|-----------|--------------|----------|
| `PDFParser` | `PDFParser` | ë™ì¼ (ìœ ì§€) |
| `parse_pdf()` | `parse_pdf()` | ë™ì¼ (ìœ ì§€) |
| `_structure_elements()` | `_structure_elements()` | ë™ì¼ (ìœ ì§€) |
| `_extract_text_from_html()` | `_extract_text_from_html()` | ë™ì¼ (ìœ ì§€) |
| `_extract_font_size()` | `_extract_font_size()` | ë™ì¼ (ìœ ì§€) |
| `_calculate_bbox()` | `_calculate_bbox()` | ë™ì¼ (ìœ ì§€) |
| `_split_pages_by_side()` | - | í•„ìš” ì—¬ë¶€ í™•ì¸ í•„ìš” |
| `_clean_pages()` | - | í•„ìš” ì—¬ë¶€ í™•ì¸ í•„ìš” |

**ë³€ê²½ í•„ìš” ì‚¬í•­**:
- ì´ëª¨ì§€ ì œê±°, ë¡œê¹… í˜•ì‹ ë³€ê²½
- ì„¤ì • ê´€ë¦¬: `Settings` í´ë˜ìŠ¤ ì‚¬ìš©
- `CacheManager` í†µí•© í™•ì¸
- ì–‘ë©´ ë¶„ë¦¬ ë¡œì§ í•„ìš” ì—¬ë¶€ í™•ì¸

### CacheManager

| ì°¸ê³  íŒŒì¼ | í˜„ì¬ í”„ë¡œì íŠ¸ | ë³€ê²½ ì‚¬í•­ |
|-----------|--------------|----------|
| `CacheManager` | `CacheManager` | ë™ì¼ (ìœ ì§€) |
| `get_file_hash()` | `get_file_hash()` | ë™ì¼ (ìœ ì§€) |
| `get_cache_key()` | `get_cache_key()` | ë™ì¼ (ìœ ì§€) |
| `get_cache_path()` | `get_cache_path()` | ë™ì¼ (ìœ ì§€) |
| `is_cache_valid()` | `is_cache_valid()` | ë™ì¼ (ìœ ì§€) |
| `get_cached_result()` | `get_cached_result()` | ë™ì¼ (ìœ ì§€) |
| `save_cache()` | `save_cache()` | ë™ì¼ (ìœ ì§€) |
| `invalidate_cache()` | `invalidate_cache()` | ë™ì¼ (ìœ ì§€) |
| `invalidate_cache_for_file()` | `invalidate_cache_for_file()` | ë™ì¼ (ìœ ì§€) |
| `cleanup_old_cache()` | `cleanup_old_cache()` | ë™ì¼ (ìœ ì§€) |
| `get_cache_stats()` | `get_cache_stats()` | ë™ì¼ (ìœ ì§€) |

**ë³€ê²½ í•„ìš” ì‚¬í•­**:
- ë¡œê¹… í˜•ì‹ ë³€ê²½ (`[INFO]`, `[ERROR]`, `[CACHE_SAVE]`)
- ìºì‹œ ë””ë ‰í† ë¦¬: `settings.cache_dir / "upstage"` ì‚¬ìš©
- ì„¤ì • ê´€ë¦¬: `Settings` í´ë˜ìŠ¤ ì‚¬ìš©

## ë³€ìˆ˜ëª… Align ê³„íš

### ê³µí†µ ê·œì¹™
- snake_case ì‚¬ìš© (í•¨ìˆ˜ëª…, ë³€ìˆ˜ëª…)
- ì˜ë¯¸ ìˆëŠ” ì´ë¦„ ì‚¬ìš©
- í˜„ì¬ í”„ë¡œì íŠ¸ ê·œì¹™ ì¤€ìˆ˜

### ì£¼ìš” ë³€ìˆ˜ëª…
- `api_key` â†’ `api_key` (ë™ì¼)
- `pdf_path` â†’ `pdf_path` (ë™ì¼)
- `cache_dir` â†’ `cache_dir` (ë™ì¼)
- `cache_key` â†’ `cache_key` (ë™ì¼)

## ìºì‹± ë¡œì§ ë¶„ì„ ë° í†µí•© ê³„íš

### ì°¸ê³  íŒŒì¼ì˜ ìºì‹± í”Œë¡œìš°
1. `PDFParser.parse_pdf()` í˜¸ì¶œ
2. `CacheManager.get_cached_result()` í™•ì¸
3. ìºì‹œ íˆíŠ¸ ì‹œ: ìºì‹œëœ API ì‘ë‹µ ë°˜í™˜
4. ìºì‹œ ë¯¸ìŠ¤ ì‹œ: `UpstageAPIClient.parse_pdf()` í˜¸ì¶œ
5. `CacheManager.save_cache()` ì €ì¥

### í˜„ì¬ í”„ë¡œì íŠ¸ í†µí•© ê³„íš
1. `PDFParser.__init__()`ì—ì„œ `CacheManager` ì´ˆê¸°í™”
2. `parse_pdf(use_cache=True)`ì—ì„œ ìºì‹œ í™•ì¸ â†’ API í˜¸ì¶œ â†’ ìºì‹œ ì €ì¥ í”Œë¡œìš° êµ¬í˜„
3. ìºì‹œ íˆíŠ¸ ì‹œ: ìºì‹œëœ API ì‘ë‹µì„ êµ¬ì¡°í™”í•˜ì—¬ ë°˜í™˜
4. ìºì‹œ ë¯¸ìŠ¤ ì‹œ: API í˜¸ì¶œ â†’ êµ¬ì¡°í™” â†’ ìºì‹œ ì €ì¥

## êµ¬í˜„ ìˆœì„œ

1. **CacheManager ì¬êµ¬í˜„** (2.3)
   - ì°¸ê³  íŒŒì¼ ê¸°ë°˜ìœ¼ë¡œ ì¬êµ¬í˜„
   - ë¡œê¹… í˜•ì‹ ë³€ê²½
   - ì„¤ì • ê´€ë¦¬ í†µí•©

2. **UpstageAPIClient ì¬êµ¬í˜„** (2.2)
   - ì°¸ê³  íŒŒì¼ ê¸°ë°˜ìœ¼ë¡œ ì¬êµ¬í˜„
   - `PyPDF2` â†’ `pypdf` ë³€ê²½
   - ì´ëª¨ì§€ ì œê±°, ë¡œê¹… í˜•ì‹ ë³€ê²½
   - ì„¤ì • ê´€ë¦¬ í†µí•©

3. **PDFParser ì¬êµ¬í˜„** (2.4)
   - ì°¸ê³  íŒŒì¼ ê¸°ë°˜ìœ¼ë¡œ ì¬êµ¬í˜„
   - ì´ëª¨ì§€ ì œê±°, ë¡œê¹… í˜•ì‹ ë³€ê²½
   - `CacheManager` í†µí•©
   - ì–‘ë©´ ë¶„ë¦¬ ë¡œì§ í•„ìš” ì—¬ë¶€ í™•ì¸

## ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ì´ëª¨ì§€ ì œê±° í™•ì¸
- [ ] ë¡œê¹… í˜•ì‹ ë³€ê²½ í™•ì¸ (`[INFO]`, `[ERROR]` í˜•ì‹)
- [ ] `PyPDF2` â†’ `pypdf` ë³€ê²½ í™•ì¸
- [ ] ì„¤ì • ê´€ë¦¬ í†µí•© í™•ì¸ (`Settings` í´ë˜ìŠ¤ ì‚¬ìš©)
- [ ] ìºì‹œ ë””ë ‰í† ë¦¬ ì„¤ì • í™•ì¸ (`settings.cache_dir / "upstage"`)
- [ ] ë³€ìˆ˜ëª…/í•¨ìˆ˜ëª… Align í™•ì¸
- [ ] ìºì‹± ì‹œìŠ¤í…œ í†µí•© í™•ì¸
- [ ] E2E í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸

